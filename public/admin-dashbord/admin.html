<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Entreprise - Casa Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="shortcut icon" href="../assets/images/logo_casahome.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --primary-blue:#2AA4CD; --primary-orange:#EB6F27; }
    body { font-family:'Poppins',sans-serif; }
    .navbar-branding { background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.08); }
    .section-card { border:none; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.06); }
    .badge-status { font-size:.75rem; }
  </style>
</head>
<body>
  <script>
    // Access guard: only 'admin' role can view this page (placeholder)
    (function(){
      try {
        const role = localStorage.getItem('userRole');
        if (role !== 'admin') {
          window.location.replace('../login.html');
        }
      } catch(_) {}
    })();
  </script>
  <nav class="navbar navbar-expand-lg navbar-branding sticky-top">
    <div class="container">
      <a class="navbar-brand" href="../../index.html">
        <img src="../assets/images/logo_casahome.png" alt="Casa Home" height="48">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="familles.html">Espace Famille</a></li>
          <li class="nav-item"><a class="nav-link" href="touristes.html">Espace Touriste</a></li>
          <li class="nav-item"><a class="nav-link active" href="admin.html">Admin Entreprise</a></li>
        </ul>
        <div class="d-flex gap-2">
          <a class="btn btn-outline-primary" href="../login.html">Connexion</a>
          <a class="btn btn-primary" href="../register.html">Inscription</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="container py-4">
    <div class="mb-4 p-4 bg-light rounded-3">
      <h1 class="h3 mb-1">Administration</h1>
      <p class="mb-0 text-muted">Vue d'ensemble des familles, touristes et réservations. Validation par l'entreprise.</p>
    </div>

    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pills-validations-tab" data-bs-toggle="pill" data-bs-target="#pills-validations" type="button" role="tab">Validations en attente</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-familles-tab" data-bs-toggle="pill" data-bs-target="#pills-familles" type="button" role="tab">Familles</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-touristes-tab" data-bs-toggle="pill" data-bs-target="#pills-touristes" type="button" role="tab">Touristes</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="pills-reservations-tab" data-bs-toggle="pill" data-bs-target="#pills-reservations" type="button" role="tab">Réservations</button>
      </li>
    </ul>

    <div class="tab-content" id="pills-tabContent">
      <div class="tab-pane fade show active" id="pills-validations" role="tabpanel">
        <div class="card section-card">
          <div class="card-body">
            <h2 class="h5 mb-3">Demandes à valider</h2>
            <div class="table-responsive">
              <table class="table align-middle" id="tableValidations">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Nom</th>
                    <th>Détails</th>
                    <th class="text-end">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Rempli en JS (démo) -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="pills-familles" role="tabpanel">
        <div class="card section-card">
          <div class="card-body">
            <h2 class="h5 mb-3">Familles</h2>
            <div class="table-responsive">
              <table class="table align-middle" id="tableFamilles">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Localisation</th>
                    <th>Capacité</th>
                    <th>Statut</th>
                    <th class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="pills-touristes" role="tabpanel">
        <div class="card section-card">
          <div class="card-body">
            <h2 class="h5 mb-3">Touristes</h2>
            <div class="table-responsive">
              <table class="table align-middle" id="tableTouristes">
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Réservations</th>
                    <th class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="tab-pane fade" id="pills-reservations" role="tabpanel">
        <div class="card section-card">
          <div class="card-body">
            <h2 class="h5 mb-3">Réservations</h2>
            <div class="table-responsive">
              <table class="table align-middle" id="tableReservations">
                <thead>
                  <tr>
                    <th>Famille</th>
                    <th>Touriste</th>
                    <th>Période</th>
                    <th>Statut</th>
                    <th class="text-end">Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="mt-5" style="background:#2AA4CD;color:#fff;">
    <div class="container py-4 d-flex flex-column flex-md-row align-items-center justify-content-between">
      <div>&copy; <span id="year"></span> Casa Home</div>
      <div class="d-flex gap-3">
        <a class="text-white text-decoration-none" href="../../index.html">Accueil</a>
        <a class="text-white text-decoration-none" href="../contact.html">Contact</a>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    // Jeux de données démo
    const validations = [
      { type:'Famille', nom:'Famille Diatta', details:'Mise à jour tarif et photos' },
      { type:'Réservation', nom:'Touriste: A. Dupont', details:'Séjour chez Famille Sané (2025-09-05 → 2025-09-10)' }
    ];
    const familles = [
      { nom:'Famille Diatta', loc:'Ziguinchor', capacite:4, statut:'En attente' },
      { nom:'Famille Sané', loc:'Cap Skirring', capacite:2, statut:'Active' }
    ];
    const touristes = [
      { nom:'Alice Dupont', email:'alice@example.com', nb:2 },
      { nom:'Marc Ndiaye', email:'marc@example.com', nb:1 }
    ];
    const reservations = [
      { famille:'Famille Sané', touriste:'Alice Dupont', debut:'2025-09-05', fin:'2025-09-10', statut:'Confirmée' },
      { famille:'Famille Diatta', touriste:'Marc Ndiaye', debut:'2025-08-20', fin:'2025-08-25', statut:'En attente' }
    ];

    function badge(status){
      const map={ 'Active':'success','En attente':'warning','Suspendue':'secondary','Confirmée':'success','Annulée':'secondary' };
      const color = map[status] || 'light';
      return `<span class="badge bg-${color} badge-status">${status}</span>`;
    }
    function renderValidations(){
      const tbody = document.querySelector('#tableValidations tbody');
      tbody.innerHTML = '';
      validations.forEach((v,idx)=>{
        tbody.insertAdjacentHTML('beforeend', `
          <tr>
            <td>${v.type}</td>
            <td>${v.nom}</td>
            <td>${v.details}</td>
            <td class="text-end">
              <button class="btn btn-sm btn-success me-2" onclick="valider(${idx})"><i class="bi bi-check2"></i> Valider</button>
              <button class="btn btn-sm btn-outline-danger" onclick="rejeter(${idx})"><i class="bi bi-x"></i> Rejeter</button>
            </td>
          </tr>`);
      });
    }
    function renderFamilles(){
      const tbody = document.querySelector('#tableFamilles tbody');
      tbody.innerHTML='';
      familles.forEach((f,i)=>{
        tbody.insertAdjacentHTML('beforeend', `
          <tr>
            <td>${f.nom}</td>
            <td>${f.loc}</td>
            <td>${f.capacite}</td>
            <td>${badge(f.statut)}</td>
            <td class="text-end">
              <button class="btn btn-sm btn-outline-secondary me-2" onclick="alert('Voir fiche de ${f.nom}')">Voir</button>
              <button class="btn btn-sm btn-primary" onclick="toggleFamille(${i})">${f.statut==='Active'?'Désactiver':'Activer'}</button>
            </td>
          </tr>`);
      });
    }
    function renderTouristes(){
      const tbody = document.querySelector('#tableTouristes tbody');
      tbody.innerHTML='';
      touristes.forEach(t=>{
        tbody.insertAdjacentHTML('beforeend', `
          <tr>
            <td>${t.nom}</td>
            <td>${t.email}</td>
            <td>${t.nb}</td>
            <td class="text-end"><button class="btn btn-sm btn-outline-secondary" onclick="alert('Historique de ${t.nom}')">Historique</button></td>
          </tr>`);
      });
    }
    function renderReservations(){
      const tbody = document.querySelector('#tableReservations tbody');
      tbody.innerHTML='';
      reservations.forEach((r,i)=>{
        tbody.insertAdjacentHTML('beforeend', `
          <tr>
            <td>${r.famille}</td>
            <td>${r.touriste}</td>
            <td><i class="bi bi-calendar3 me-1"></i>${r.debut} → ${r.fin}</td>
            <td>${badge(r.statut)}</td>
            <td class="text-end">
              ${r.statut==='En attente'?`<button class="btn btn-sm btn-success" onclick="confirmerReservation(${i})">Confirmer</button>`:''}
            </td>
          </tr>`);
      });
    }
    function valider(idx){ validations.splice(idx,1); renderValidations(); alert('Demande validée.'); }
    function rejeter(idx){ validations.splice(idx,1); renderValidations(); alert('Demande rejetée.'); }
    function toggleFamille(i){ familles[i].statut = familles[i].statut==='Active'?'Suspendue':'Active'; renderFamilles(); }
    function confirmerReservation(i){ reservations[i].statut='Confirmée'; renderReservations(); }

    renderValidations();
    renderFamilles();
    renderTouristes();
    renderReservations();
  </script>
</body>
</html>


